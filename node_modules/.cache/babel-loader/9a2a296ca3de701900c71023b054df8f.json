{"ast":null,"code":"import _slicedToArray from\"/Users/xiaoxiaoliu/Documents/5610assignment/frontend-xiaoxiaoliu/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect,useCallback}from\"react\";import MovieDataService from\"../services/movies\";import{Link}from\"react-router-dom\";import Form from\"react-bootstrap/Form\";import Button from\"react-bootstrap/Button\";import Col from\"react-bootstrap/Col\";import Row from\"react-bootstrap/Row\";import Container from\"react-bootstrap/Container\";import Card from\"react-bootstrap/Card\";import\"./MoviesList.css\";import ReplacementImage from\"./NoPosterAvailable-crop.jpeg\";// import { findByTitle } from \"@testing-library/react\";\n// import  Image  from \"react-bootstrap/Image\";\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var MoviesList=function MoviesList(props){//use state to set state values\nvar _useState=useState([]),_useState2=_slicedToArray(_useState,2),movies=_useState2[0],setMovies=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),searchTitle=_useState4[0],setSearchTitle=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),searchRating=_useState6[0],setSearchRating=_useState6[1];var _useState7=useState([\"All Ratings\"]),_useState8=_slicedToArray(_useState7,2),ratings=_useState8[0],setRatings=_useState8[1];var _useState9=useState(0),_useState10=_slicedToArray(_useState9,2),currentPage=_useState10[0],setCurrentPage=_useState10[1];var _useState11=useState(0),_useState12=_slicedToArray(_useState11,2),entriesPerPage=_useState12[0],setEntriesPerPage=_useState12[1];var _useState13=useState(\"\"),_useState14=_slicedToArray(_useState13,2),currentSearchMode=_useState14[0],setCurrentSearchMode=_useState14[1];// useCallback to define functions which should only be created once and will be dependencies for useEffect\nvar retrieveRatings=useCallback(function(){MovieDataService.getRatings().then(function(response){setRatings([\"All Rating\"].concat(response.data));}).catch(function(e){console.log(e);});},[]);var retrieveMovies=useCallback(function(){setCurrentSearchMode(\"\");MovieDataService.getAll(currentPage).then(function(response){setMovies(response.data.movies);setCurrentPage(response.data.page);setEntriesPerPage(response.data.entries_per_page);}).catch(function(e){console.log(e);});},[currentPage]);var find=useCallback(function(query,by){MovieDataService.find(query,by,currentPage).then(function(response){setMovies(response.data.movies);}).catch(function(e){console.log(e);});},[currentPage]);var findByTitle=useCallback(function(){setCurrentSearchMode(\"findByTitle\");find(searchTitle,\"title\");},[find,searchTitle]);var findByRating=useCallback(function(){setCurrentSearchMode(\"findByRating\");if(searchRating===\"All Ratings\"){retrieveMovies();}else{find(searchRating,\"rated\");}},[find,searchRating,retrieveMovies]);var retrieveNextPage=useCallback(function(){if(currentSearchMode===\"findByTitle\"){findByTitle();}else if(currentSearchMode===\"findByRating\"){findByRating();}else{retrieveMovies();}},[currentSearchMode,findByTitle,findByRating,retrieveMovies]);// Use effect to carry out side effect functionality\nuseEffect(function(){retrieveRatings();},[retrieveRatings]);useEffect(function(){setCurrentPage(0);},[currentSearchMode]);useEffect(function(){retrieveNextPage();},[currentPage,retrieveNextPage]);var onChangeSearchTitle=function onChangeSearchTitle(e){var searchTitle=e.target.value;setSearchTitle(searchTitle);};var onChangeSearchRating=function onChangeSearchRating(e){var searchRating=e.target.value;setSearchRating(searchRating);};return/*#__PURE__*/_jsx(\"div\",{className:\"App\",children:/*#__PURE__*/_jsxs(Container,{className:\"main-container\",children:[/*#__PURE__*/_jsx(Form,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsxs(Col,{children:[/*#__PURE__*/_jsx(Form.Group,{className:\"mb-3\",children:/*#__PURE__*/_jsx(Form.Control,{type:\"text\",placeholder:\"Search by Title\",value:searchTitle,onChange:onChangeSearchTitle})}),/*#__PURE__*/_jsx(Button,{variant:\"primary\",type:\"button\",onClick:findByTitle,children:\"Search\"})]}),/*#__PURE__*/_jsxs(Col,{children:[/*#__PURE__*/_jsx(Form.Group,{className:\"mb-3\",children:/*#__PURE__*/_jsx(Form.Control,{as:\"select\",onChange:onChangeSearchRating,children:ratings.map(function(rating,i){return/*#__PURE__*/_jsx(\"option\",{value:rating,children:rating},i);})})}),/*#__PURE__*/_jsx(Button,{variant:\"primary\",type:\"button\",onClick:findByRating,children:\"Search\"})]})]})}),/*#__PURE__*/_jsx(Row,{className:\"movieRow\",children:movies.map(function(movie){return/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsxs(Card,{className:\"moviesListCard\",children:[/*#__PURE__*/_jsx(Card.Img,{className:\"smallPoster\",src:movie.poster+\"/100px180\",onError:function onError(e){e.target.src=ReplacementImage;}}),/*#__PURE__*/_jsxs(Card.Body,{children:[/*#__PURE__*/_jsxs(Card.Title,{children:[\" \",movie.title]}),/*#__PURE__*/_jsxs(Card.Text,{children:[\"Rating:\",movie.rated]}),/*#__PURE__*/_jsx(Card.Text,{children:movie.plot}),/*#__PURE__*/_jsx(Link,{to:\"/movies/\"+movie._id,children:\"View Reviews\"})]})]})},movie._id);})}),/*#__PURE__*/_jsx(\"br\",{}),\"Showing page: \",currentPage+1,\".\",/*#__PURE__*/_jsxs(Button,{variant:\"link\",onClick:function onClick(){setCurrentPage(currentPage+1);},children:[\"Get next \",entriesPerPage,\" results\"]})]})});};export default MoviesList;","map":{"version":3,"names":["React","useState","useEffect","useCallback","MovieDataService","Link","Form","Button","Col","Row","Container","Card","ReplacementImage","MoviesList","props","movies","setMovies","searchTitle","setSearchTitle","searchRating","setSearchRating","ratings","setRatings","currentPage","setCurrentPage","entriesPerPage","setEntriesPerPage","currentSearchMode","setCurrentSearchMode","retrieveRatings","getRatings","then","response","concat","data","catch","e","console","log","retrieveMovies","getAll","page","entries_per_page","find","query","by","findByTitle","findByRating","retrieveNextPage","onChangeSearchTitle","target","value","onChangeSearchRating","map","rating","i","movie","poster","src","title","rated","plot","_id"],"sources":["/Users/xiaoxiaoliu/Documents/5610assignment/frontend-xiaoxiaoliu/src/components/MoviesList.js"],"sourcesContent":["import React, { useState, useEffect, useCallback } from \"react\";\nimport MovieDataService from \"../services/movies\";\nimport { Link } from \"react-router-dom\";\nimport Form from \"react-bootstrap/Form\";\nimport Button from \"react-bootstrap/Button\";\nimport Col from \"react-bootstrap/Col\";\nimport Row from \"react-bootstrap/Row\";\nimport Container from \"react-bootstrap/Container\";\nimport Card from \"react-bootstrap/Card\";\nimport \"./MoviesList.css\";\nimport ReplacementImage from \"./NoPosterAvailable-crop.jpeg\";\n// import { findByTitle } from \"@testing-library/react\";\n// import  Image  from \"react-bootstrap/Image\";\nconst MoviesList = props => {\n    //use state to set state values\n    const [movies, setMovies] = useState([]);\n    const [searchTitle, setSearchTitle] = useState(\"\");\n    const [searchRating, setSearchRating] = useState(\"\");\n    const [ratings, setRatings] = useState([\"All Ratings\"]);\n    const [currentPage, setCurrentPage] = useState(0);\n    const [entriesPerPage, setEntriesPerPage] = useState(0);\n    const [currentSearchMode, setCurrentSearchMode] = useState(\"\")\n    // useCallback to define functions which should only be created once and will be dependencies for useEffect\n    const retrieveRatings = useCallback(() => {\n        MovieDataService.getRatings()\n            .then(response => {\n                setRatings([\"All Rating\"].concat(response.data))\n            })\n            .catch(e => {\n                console.log(e);\n            });\n    }, []);\n\n    const retrieveMovies = useCallback(() => {\n        setCurrentSearchMode(\"\");\n        MovieDataService.getAll(currentPage)\n            .then(response => {\n                setMovies(response.data.movies);\n                setCurrentPage(response.data.page);\n                setEntriesPerPage(response.data.entries_per_page);\n            })\n            .catch(e => {\n                console.log(e);\n            });\n    }, [currentPage]);\n\n    const find = useCallback((query, by) => {\n        MovieDataService.find(query, by, currentPage)\n            .then(response => {\n                setMovies(response.data.movies);\n            })\n            .catch(e => {\n                console.log(e);\n            });\n    }, [currentPage]);\n\n    const findByTitle = useCallback(() => {\n        setCurrentSearchMode(\"findByTitle\");\n        find(searchTitle, \"title\");\n    }, [find, searchTitle]);\n\n    const findByRating = useCallback(() => {\n        setCurrentSearchMode(\"findByRating\");\n        if (searchRating === \"All Ratings\") {\n            retrieveMovies();\n        } else {\n            find(searchRating, \"rated\");\n        }\n    }, [find, searchRating, retrieveMovies]);\n\n    const retrieveNextPage = useCallback(() => {\n        if (currentSearchMode === \"findByTitle\") {\n            findByTitle();\n        } else if (currentSearchMode === \"findByRating\") {\n            findByRating();\n        }else {\n            retrieveMovies();\n        }\n    }, [currentSearchMode, findByTitle, findByRating, retrieveMovies]);\n    // Use effect to carry out side effect functionality\n    useEffect(() => {\n        retrieveRatings();\n    }, [retrieveRatings]);\n\n    useEffect(() => {\n        setCurrentPage(0);\n    }, [currentSearchMode]);\n\n    useEffect(() => {\n        retrieveNextPage();\n    }, [currentPage, retrieveNextPage]);\n\n    const onChangeSearchTitle = e => {\n        const searchTitle = e.target.value;\n        setSearchTitle(searchTitle);\n    }\n\n    const onChangeSearchRating = e => {\n        const searchRating = e.target.value;\n        setSearchRating(searchRating);\n    }\n\n\n    return (\n        <div className=\"App\">\n            <Container className=\"main-container\">\n                <Form>\n                    <Row>\n                        <Col>\n                            <Form.Group className=\"mb-3\">\n                                <Form.Control\n                                    type=\"text\"\n                                    placeholder=\"Search by Title\"\n                                    value={searchTitle}\n                                    onChange={onChangeSearchTitle} />\n                            </Form.Group>\n                            <Button\n                                variant=\"primary\"\n                                type=\"button\"\n                                onClick={findByTitle}>\n                                Search\n                            </Button>\n                        </Col>\n                        <Col>\n                            <Form.Group className=\"mb-3\">\n                                <Form.Control\n                                    as=\"select\"\n                                    onChange={onChangeSearchRating}>\n                                    {ratings.map((rating, i) => {\n                                        return (\n                                            <option value={rating}\n                                                key={i}>\n                                                {rating}\n                                            </option>\n                                        )\n                                    })}\n                                </Form.Control>\n                            </Form.Group>\n                            <Button\n                                variant=\"primary\"\n                                type=\"button\"\n                                onClick={findByRating}>\n                                Search\n                            </Button>\n                        </Col>\n                    </Row>\n                </Form>\n                <Row className=\"movieRow\">\n                    {movies.map((movie) => {\n                        return (\n                            <Col key={movie._id}>\n                                <Card className=\"moviesListCard\">\n                                    <Card.Img\n                                        className=\"smallPoster\"\n                                        src={movie.poster + \"/100px180\"}\n                                        onError={(e) => {\n                                            e.target.src = ReplacementImage\n                                        }} />\n                                    <Card.Body>\n                                        <Card.Title> {movie.title}</Card.Title>\n                                        <Card.Text>\n                                            Rating:{movie.rated}\n                                        </Card.Text>\n                                        <Card.Text>\n                                            {movie.plot}\n                                        </Card.Text>\n                                        <Link to={\"/movies/\" + movie._id}>\n                                            View Reviews\n                                        </Link>\n                                    </Card.Body>\n                                </Card>\n                            </Col>\n                        )\n                    })}\n                </Row>\n                <br />\n                Showing page: {currentPage + 1}.\n                <Button\n                    variant=\"link\"\n                    onClick={() => { setCurrentPage(currentPage + 1) }}>\n                    Get next {entriesPerPage} results\n                </Button>\n            </Container>\n        </div>\n    )\n}\n\nexport default MoviesList;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}